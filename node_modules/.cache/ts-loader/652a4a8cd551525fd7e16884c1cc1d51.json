{"remainingRequest":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\thread-loader\\dist\\cjs.js!E:\\WebStormProject\\blog-vue-typescript\\node_modules\\babel-loader\\lib\\index.js!E:\\WebStormProject\\blog-vue-typescript\\node_modules\\ts-loader\\index.js??ref--13-3!E:\\WebStormProject\\blog-vue-typescript\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\WebStormProject\\blog-vue-typescript\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\WebStormProject\\blog-vue-typescript\\src\\views\\articleDetail.vue?vue&type=script&lang=ts&","dependencies":[{"path":"E:\\WebStormProject\\blog-vue-typescript\\src\\views\\articleDetail.vue","mtime":1573558720918},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\ts-loader\\index.js","mtime":1545640398000},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/inherits\";\nimport * as tslib_1 from \"tslib\";\nimport { Component, Vue } from \"vue-property-decorator\";\nimport { isMobileOrPc } from \"@/utils/utils\";\nimport markdown from \"@/utils/markdown\";\nimport LoadingCustom from \"@/components/loading.vue\";\nimport CommentList from \"@/components/commentList.vue\";\n\nvar ArticleDetail =\n/*#__PURE__*/\nfunction (_Vue) {\n  _inherits(ArticleDetail, _Vue);\n\n  function ArticleDetail() {\n    var _this;\n\n    _classCallCheck(this, ArticleDetail);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ArticleDetail).apply(this, arguments));\n    _this.btnLoading = false;\n    _this.isLoadEnd = false;\n    _this.isLoading = false;\n    _this.isMobileOrPc = isMobileOrPc();\n    _this.params = {\n      id: \"\",\n      type: 1 //文章类型 => 1: 普通文章，2: 简历，3: 管理员介绍\n\n    };\n    _this.content = \"\";\n    _this.articleDetail = {\n      toc: \"\",\n      _id: \"\",\n      author: \"biaochenxuying\",\n      category: [],\n      comments: [],\n      create_time: \"\",\n      desc: \"\",\n      content: \"\",\n      id: 16,\n      img_url: \"\",\n      numbers: 0,\n      keyword: [],\n      like_users: [],\n      meta: {\n        views: 0,\n        likes: 0,\n        comments: 0\n      },\n      origin: 0,\n      state: 1,\n      tags: [],\n      title: \"\",\n      update_time: \"\"\n    };\n    _this.cacheTime = 0; // 缓存时间\n\n    _this.times = 0; // 评论次数\n\n    _this.likeTimes = 0; // 点赞次数\n\n    return _this;\n  }\n\n  _createClass(ArticleDetail, [{\n    key: \"mounted\",\n    value: function mounted() {\n      this.params.id = this.$route.query.article_id; // this.params.id = \"5c8cfe5d26bb39b22d3a7aec\";\n\n      if (this.$route.path === \"/about\") {\n        this.params.type = 3;\n      }\n\n      this.handleSearch();\n    }\n  }, {\n    key: \"refreshArticle\",\n    value: function refreshArticle() {\n      this.handleSearch();\n    }\n  }, {\n    key: \"handleAddComment\",\n    value: function () {\n      var _handleAddComment = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var now, nowTime, user_id, userInfo;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (this.articleDetail._id) {\n                  _context.next = 3;\n                  break;\n                }\n\n                this.$message({\n                  message: \"该文章不存在！\",\n                  type: \"error\"\n                });\n                return _context.abrupt(\"return\");\n\n              case 3:\n                if (!(this.times > 2)) {\n                  _context.next = 6;\n                  break;\n                }\n\n                this.$message({\n                  message: \"您今天评论的次数已经用完，明天再来评论吧！\",\n                  type: \"warning\"\n                });\n                return _context.abrupt(\"return\");\n\n              case 6:\n                now = new Date();\n                nowTime = now.getTime();\n\n                if (!(nowTime - this.cacheTime < 4000)) {\n                  _context.next = 11;\n                  break;\n                }\n\n                this.$message({\n                  message: \"您评论太过频繁，1 分钟后再来留言吧！\",\n                  type: \"warning\"\n                });\n                return _context.abrupt(\"return\");\n\n              case 11:\n                if (this.content) {\n                  _context.next = 14;\n                  break;\n                }\n\n                this.$message({\n                  message: \"请输入内容!\",\n                  type: \"warning\"\n                });\n                return _context.abrupt(\"return\");\n\n              case 14:\n                user_id = \"\";\n\n                if (!window.sessionStorage.userInfo) {\n                  _context.next = 20;\n                  break;\n                }\n\n                userInfo = JSON.parse(window.sessionStorage.userInfo);\n                user_id = userInfo._id;\n                _context.next = 22;\n                break;\n\n              case 20:\n                this.$message({\n                  message: \"登录才能评论，请先登录！\",\n                  type: \"warning\"\n                });\n                return _context.abrupt(\"return\");\n\n              case 22:\n                this.btnLoading = true;\n                _context.next = 25;\n                return this.$https.post(this.$urls.addComment, {\n                  article_id: this.articleDetail._id,\n                  user_id: user_id,\n                  content: this.content\n                });\n\n              case 25:\n                this.btnLoading = false;\n                this.times++;\n                this.cacheTime = nowTime;\n                this.content = \"\";\n                this.$message({\n                  message: \"操作成功\",\n                  type: \"success\"\n                });\n                this.handleSearch();\n\n              case 31:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function handleAddComment() {\n        return _handleAddComment.apply(this, arguments);\n      }\n\n      return handleAddComment;\n    }()\n  }, {\n    key: \"beforeDestroy\",\n    value: function beforeDestroy() {\n      document.title = \"夜尽天明的博客网站\";\n      document.getElementById(\"keywords\").setAttribute(\"content\", \"夜尽天明 的博客网站\");\n      document.getElementById(\"description\").setAttribute(\"content\", \"分享大前端开发等相关的技术文章，热点资源，全栈程序员的成长之路。\");\n    } // // The class component now treats beforeRouteEnter\n    // // and beforeRouteLeave as Vue Router hooks\n    // beforeRouteEnter (to, from, next) {\n    //   console.log('beforeRouteEnter')\n    //   next() // needs to be called to confirm the navigation\n    // }\n    // beforeRouteLeave (to, from, next) {\n    //   console.log('beforeRouteLeave')\n    //   document.title = \"夜尽天明的博客网站\";\n    //   document\n    //     .getElementById(\"keywords\")\n    //     .setAttribute(\"content\", \"夜尽天明 的博客网站\");\n    //   document\n    //     .getElementById(\"description\")\n    //     .setAttribute(\n    //       \"content\",\n    //       \"分享大前端开发等相关的技术文章，热点资源，全栈程序员的成长之路。\"\n    //     );\n    //   next() // needs to be called to confirm the navigation\n    // }\n\n  }, {\n    key: \"handleSearch\",\n    value: function () {\n      var _handleSearch = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        var _this2 = this;\n\n        var data, article, keyword, description, title;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.isLoading = true;\n                _context2.next = 3;\n                return this.$https.post(this.$urls.getArticleDetail, this.params);\n\n              case 3:\n                data = _context2.sent;\n                this.isLoading = false;\n                this.articleDetail = data;\n                article = markdown.marked(data.content);\n                article.then(function (res) {\n                  _this2.articleDetail.content = res.content;\n                  _this2.articleDetail.toc = res.toc;\n                });\n                keyword = data.keyword.join(\",\");\n                description = data.desc;\n                title = data.title;\n                document.title = title;\n                document.querySelector(\"#keywords\").setAttribute(\"content\", keyword);\n                document.querySelector(\"#description\").setAttribute(\"content\", description);\n\n              case 14:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function handleSearch() {\n        return _handleSearch.apply(this, arguments);\n      }\n\n      return handleSearch;\n    }()\n  }, {\n    key: \"likeArticle\",\n    value: function () {\n      var _likeArticle = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee3() {\n        var user_id, userInfo, params;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (this.articleDetail._id) {\n                  _context3.next = 3;\n                  break;\n                }\n\n                this.$message({\n                  message: \"该文章不存在！\",\n                  type: \"warning\"\n                });\n                return _context3.abrupt(\"return\");\n\n              case 3:\n                if (!(this.likeTimes > 0)) {\n                  _context3.next = 6;\n                  break;\n                }\n\n                this.$message({\n                  message: \"您已经点过赞了！悠着点吧！\",\n                  type: \"warning\"\n                });\n                return _context3.abrupt(\"return\");\n\n              case 6:\n                user_id = \"\";\n\n                if (!window.sessionStorage.userInfo) {\n                  _context3.next = 12;\n                  break;\n                }\n\n                userInfo = JSON.parse(window.sessionStorage.userInfo);\n                user_id = userInfo._id;\n                _context3.next = 14;\n                break;\n\n              case 12:\n                this.$message({\n                  message: \"登录才能点赞，请先登录！\",\n                  type: \"warning\"\n                });\n                return _context3.abrupt(\"return\");\n\n              case 14:\n                params = {\n                  id: this.articleDetail._id,\n                  user_id: user_id\n                };\n                _context3.next = 17;\n                return this.$https.post(this.$urls.likeArticle, params);\n\n              case 17:\n                this.isLoading = false;\n                this.likeTimes++;\n                ++this.articleDetail.meta.likes;\n                this.$message({\n                  message: \"操作成功\",\n                  type: \"success\"\n                });\n\n              case 21:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function likeArticle() {\n        return _likeArticle.apply(this, arguments);\n      }\n\n      return likeArticle;\n    }()\n  }]);\n\n  return ArticleDetail;\n}(Vue);\n\nArticleDetail = tslib_1.__decorate([Component({\n  components: {\n    LoadingCustom: LoadingCustom,\n    CommentList: CommentList\n  }\n})], ArticleDetail);\nexport default ArticleDetail;",null]}