{"remainingRequest":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\babel-loader\\lib\\index.js!E:\\WebStormProject\\blog-vue-typescript\\node_modules\\ts-loader\\index.js??ref--13-2!E:\\WebStormProject\\blog-vue-typescript\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\WebStormProject\\blog-vue-typescript\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\WebStormProject\\blog-vue-typescript\\src\\components\\registerAndLogin.vue?vue&type=script&lang=ts&","dependencies":[{"path":"E:\\WebStormProject\\blog-vue-typescript\\src\\components\\registerAndLogin.vue","mtime":1573558720910},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\ts-loader\\index.js","mtime":1545640398000},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport \"core-js/modules/es6.regexp.constructor\";\nimport _JSON$stringify from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/json/stringify\";\nimport \"core-js/modules/es6.function.name\";\nimport _classCallCheck from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/inherits\";\nimport * as tslib_1 from \"tslib\";\nimport { Component, Emit, Prop, Vue } from \"vue-property-decorator\";\nimport config from \"@/utils/config\";\n\nvar RegisterAndLogin =\n/*#__PURE__*/\nfunction (_Vue) {\n  _inherits(RegisterAndLogin, _Vue);\n\n  function RegisterAndLogin() {\n    var _this;\n\n    _classCallCheck(this, RegisterAndLogin);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(RegisterAndLogin).apply(this, arguments)); // initial data\n\n    _this.btnLoading = false;\n    _this.loading = false;\n    _this.formLabelWidth = _this.isMobile ? \"40px\" : \"60px\";\n    _this.params = {\n      email: \"\",\n      name: \"\",\n      password: \"\",\n      phone: \"\",\n      desc: \"\"\n    };\n    return _this;\n  } // lifecycle hook\n\n\n  _createClass(RegisterAndLogin, [{\n    key: \"mounted\",\n    value: function mounted() {} // computed\n\n  }, {\n    key: \"handleOAuth\",\n    // method\n    value: function handleOAuth() {\n      // 保存授权前的页面链接内容\n      var preventHistory = {\n        name: this.$route.name,\n        query: this.$route.query\n      };\n      window.sessionStorage.preventHistory = _JSON$stringify(preventHistory); // window.location.href = 'https://github.com/login/oauth/authorize?client_id=6de90ab270aea2bdb01c&redirect_uri=http://biaochenxuying.cn/login'\n\n      window.location.href = \"\".concat(config.oauth_uri, \"?client_id=\").concat(config.client_id, \"&redirect_uri=\").concat(config.redirect_uri);\n    }\n  }, {\n    key: \"handleOk\",\n    value: function handleOk() {\n      var reg = new RegExp(\"^[a-z0-9]+([._\\\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$\"); //正则表达式\n\n      if (!this.params.email) {\n        // Message.warning(\"邮箱不能为空！\");\n        this.$message({\n          message: \"邮箱不能为空！\",\n          type: \"warning\"\n        });\n        return;\n      } else if (!reg.test(this.params.email)) {\n        this.$message({\n          message: \"请输入格式正确的邮箱！\",\n          type: \"warning\"\n        });\n        return;\n      }\n\n      if (this.handleFlag === \"register\") {\n        if (!this.params.password) {\n          this.$message({\n            message: \"密码不能为空！\",\n            type: \"warning\"\n          });\n          return;\n        } else if (!this.params.name) {\n          this.$message({\n            message: \"用户名不能为空！\",\n            type: \"warning\"\n          });\n          return;\n        }\n\n        var re = /^(((13[0-9]{1})|(15[0-9]{1})|(17[0-9]{1})|(18[0-9]{1}))+\\d{8})$/;\n\n        if (this.params.phone && !re.test(this.params.phone)) {\n          this.$message({\n            message: \"请输入正确的手机号!\",\n            type: \"warning\"\n          });\n          return;\n        }\n      }\n\n      this.submit();\n    } // this.$emit\n\n  }, {\n    key: \"cancel\",\n    value: function cancel() {\n      return false;\n    }\n  }, {\n    key: \"submit\",\n    value: function () {\n      var _submit = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var data, userInfo;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                data = \"\";\n                this.btnLoading = true;\n\n                if (!(this.handleFlag === \"register\")) {\n                  _context.next = 8;\n                  break;\n                }\n\n                _context.next = 5;\n                return this.$https.post(this.$urls.register, this.params);\n\n              case 5:\n                data = _context.sent;\n                _context.next = 11;\n                break;\n\n              case 8:\n                _context.next = 10;\n                return this.$https.post(this.$urls.login, this.params);\n\n              case 10:\n                data = _context.sent;\n\n              case 11:\n                this.btnLoading = false;\n                userInfo = {\n                  _id: data._id,\n                  name: data.name,\n                  avatar: data.avatar\n                };\n                this.$store.commit(\"SAVE_USER\", {\n                  userInfo: userInfo\n                });\n                window.sessionStorage.userInfo = _JSON$stringify(userInfo);\n                this.$message({\n                  message: \"操作成功\",\n                  type: \"success\"\n                });\n\n              case 16:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function submit() {\n        return _submit.apply(this, arguments);\n      }\n\n      return submit;\n    }()\n  }, {\n    key: \"dialogVisible\",\n    get: function get() {\n      return this.visible;\n    }\n  }]);\n\n  return RegisterAndLogin;\n}(Vue);\n\ntslib_1.__decorate([Prop({\n  default: false\n})], RegisterAndLogin.prototype, \"visible\", void 0);\n\ntslib_1.__decorate([Prop({\n  default: false\n})], RegisterAndLogin.prototype, \"handleFlag\", void 0);\n\ntslib_1.__decorate([Prop({\n  default: false\n})], RegisterAndLogin.prototype, \"isMobile\", void 0);\n\ntslib_1.__decorate([Emit()], RegisterAndLogin.prototype, \"cancel\", null);\n\ntslib_1.__decorate([Emit(\"ok\")], RegisterAndLogin.prototype, \"submit\", null);\n\nRegisterAndLogin = tslib_1.__decorate([Component({// components: {}\n})], RegisterAndLogin);\nexport default RegisterAndLogin;",{"version":3,"sources":["E:\\WebStormProject\\blog-vue-typescript\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\WebStormProject\\blog-vue-typescript\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\WebStormProject\\blog-vue-typescript\\src\\components\\registerAndLogin.vue?vue&type=script&lang=ts&"],"names":[],"mappings":"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","sourcesContent":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Emit, Prop, Vue } from \"vue-property-decorator\";\r\nimport config from \"@/utils/config\";\r\nimport { RegAndLogParams, UserInfo } from \"@/types/index\";\r\n\r\n@Component({\r\n  // components: {}\r\n})\r\nexport default class RegisterAndLogin extends Vue {\r\n  @Prop({ default: false }) visible!: boolean;\r\n  @Prop({ default: false }) handleFlag!: string;\r\n  @Prop({ default: false }) isMobile!: string;\r\n\r\n  // initial data\r\n  private btnLoading: boolean = false;\r\n  private loading: boolean = false;\r\n  private formLabelWidth: string = this.isMobile ? \"40px\" : \"60px\";\r\n  private params: RegAndLogParams = {\r\n    email: \"\",\r\n    name: \"\",\r\n    password: \"\",\r\n    phone: \"\",\r\n    desc: \"\"\r\n  };\r\n\r\n  // lifecycle hook\r\n  mounted() {}\r\n\r\n  // computed\r\n  get dialogVisible(): boolean {\r\n    return this.visible;\r\n  }\r\n\r\n  // method\r\n  private handleOAuth(): void {\r\n    // 保存授权前的页面链接内容\r\n    let preventHistory: object = {\r\n      name: this.$route.name,\r\n      query: this.$route.query\r\n    };\r\n    window.sessionStorage.preventHistory = JSON.stringify(preventHistory);\r\n    // window.location.href = 'https://github.com/login/oauth/authorize?client_id=6de90ab270aea2bdb01c&redirect_uri=http://biaochenxuying.cn/login'\r\n    window.location.href = `${config.oauth_uri}?client_id=${config.client_id}&redirect_uri=${config.redirect_uri}`;\r\n  }\r\n\r\n  private handleOk(): void {\r\n    const reg = new RegExp(\r\n      \"^[a-z0-9]+([._\\\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$\"\r\n    ); //正则表达式\r\n    if (!this.params.email) {\r\n      // Message.warning(\"邮箱不能为空！\");\r\n      this.$message({\r\n        message: \"邮箱不能为空！\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    } else if (!reg.test(this.params.email)) {\r\n      this.$message({\r\n        message: \"请输入格式正确的邮箱！\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    }\r\n    if (this.handleFlag === \"register\") {\r\n      if (!this.params.password) {\r\n        this.$message({\r\n          message: \"密码不能为空！\",\r\n          type: \"warning\"\r\n        });\r\n        return;\r\n      } else if (!this.params.name) {\r\n        this.$message({\r\n          message: \"用户名不能为空！\",\r\n          type: \"warning\"\r\n        });\r\n        return;\r\n      }\r\n      const re = /^(((13[0-9]{1})|(15[0-9]{1})|(17[0-9]{1})|(18[0-9]{1}))+\\d{8})$/;\r\n      if (this.params.phone && !re.test(this.params.phone)) {\r\n        this.$message({\r\n          message: \"请输入正确的手机号!\",\r\n          type: \"warning\"\r\n        });\r\n        return;\r\n      }\r\n    }\r\n    this.submit();\r\n  }\r\n\r\n  // this.$emit\r\n  @Emit()\r\n  private cancel(): boolean {\r\n    return false;\r\n  }\r\n  @Emit(\"ok\")\r\n  private async submit(): Promise<void> {\r\n    let data: any = \"\";\r\n    this.btnLoading = true;\r\n    if (this.handleFlag === \"register\") {\r\n      data = await this.$https.post(this.$urls.register, this.params);\r\n    } else {\r\n      data = await this.$https.post(this.$urls.login, this.params);\r\n    }\r\n    this.btnLoading = false;\r\n\r\n    const userInfo: UserInfo = {\r\n      _id: data._id,\r\n      name: data.name,\r\n      avatar: data.avatar\r\n    };\r\n    this.$store.commit(\"SAVE_USER\", {\r\n      userInfo\r\n    });\r\n    window.sessionStorage.userInfo = JSON.stringify(userInfo);\r\n    this.$message({\r\n      message: \"操作成功\",\r\n      type: \"success\"\r\n    });\r\n  }\r\n}\r\n"],"sourceRoot":""}]}