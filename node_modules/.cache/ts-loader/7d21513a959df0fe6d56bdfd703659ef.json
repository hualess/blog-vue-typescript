{"remainingRequest":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\babel-loader\\lib\\index.js!E:\\WebStormProject\\blog-vue-typescript\\node_modules\\ts-loader\\index.js??ref--13-2!E:\\WebStormProject\\blog-vue-typescript\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\WebStormProject\\blog-vue-typescript\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\WebStormProject\\blog-vue-typescript\\src\\views\\articleDetail.vue?vue&type=script&lang=ts&","dependencies":[{"path":"E:\\WebStormProject\\blog-vue-typescript\\src\\views\\articleDetail.vue","mtime":1573558720918},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\ts-loader\\index.js","mtime":1545640398000},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/inherits\";\nimport * as tslib_1 from \"tslib\";\nimport { Component, Vue } from \"vue-property-decorator\";\nimport { isMobileOrPc } from \"@/utils/utils\";\nimport markdown from \"@/utils/markdown\";\nimport LoadingCustom from \"@/components/loading.vue\";\nimport CommentList from \"@/components/commentList.vue\";\n\nvar ArticleDetail =\n/*#__PURE__*/\nfunction (_Vue) {\n  _inherits(ArticleDetail, _Vue);\n\n  function ArticleDetail() {\n    var _this;\n\n    _classCallCheck(this, ArticleDetail);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ArticleDetail).apply(this, arguments));\n    _this.btnLoading = false;\n    _this.isLoadEnd = false;\n    _this.isLoading = false;\n    _this.isMobileOrPc = isMobileOrPc();\n    _this.params = {\n      id: \"\",\n      type: 1 //文章类型 => 1: 普通文章，2: 简历，3: 管理员介绍\n\n    };\n    _this.content = \"\";\n    _this.articleDetail = {\n      toc: \"\",\n      _id: \"\",\n      author: \"biaochenxuying\",\n      category: [],\n      comments: [],\n      create_time: \"\",\n      desc: \"\",\n      content: \"\",\n      id: 16,\n      img_url: \"\",\n      numbers: 0,\n      keyword: [],\n      like_users: [],\n      meta: {\n        views: 0,\n        likes: 0,\n        comments: 0\n      },\n      origin: 0,\n      state: 1,\n      tags: [],\n      title: \"\",\n      update_time: \"\"\n    };\n    _this.cacheTime = 0; // 缓存时间\n\n    _this.times = 0; // 评论次数\n\n    _this.likeTimes = 0; // 点赞次数\n\n    return _this;\n  }\n\n  _createClass(ArticleDetail, [{\n    key: \"mounted\",\n    value: function mounted() {\n      this.params.id = this.$route.query.article_id; // this.params.id = \"5c8cfe5d26bb39b22d3a7aec\";\n\n      if (this.$route.path === \"/about\") {\n        this.params.type = 3;\n      }\n\n      this.handleSearch();\n    }\n  }, {\n    key: \"refreshArticle\",\n    value: function refreshArticle() {\n      this.handleSearch();\n    }\n  }, {\n    key: \"handleAddComment\",\n    value: function () {\n      var _handleAddComment = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var now, nowTime, user_id, userInfo;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (this.articleDetail._id) {\n                  _context.next = 3;\n                  break;\n                }\n\n                this.$message({\n                  message: \"该文章不存在！\",\n                  type: \"error\"\n                });\n                return _context.abrupt(\"return\");\n\n              case 3:\n                if (!(this.times > 2)) {\n                  _context.next = 6;\n                  break;\n                }\n\n                this.$message({\n                  message: \"您今天评论的次数已经用完，明天再来评论吧！\",\n                  type: \"warning\"\n                });\n                return _context.abrupt(\"return\");\n\n              case 6:\n                now = new Date();\n                nowTime = now.getTime();\n\n                if (!(nowTime - this.cacheTime < 4000)) {\n                  _context.next = 11;\n                  break;\n                }\n\n                this.$message({\n                  message: \"您评论太过频繁，1 分钟后再来留言吧！\",\n                  type: \"warning\"\n                });\n                return _context.abrupt(\"return\");\n\n              case 11:\n                if (this.content) {\n                  _context.next = 14;\n                  break;\n                }\n\n                this.$message({\n                  message: \"请输入内容!\",\n                  type: \"warning\"\n                });\n                return _context.abrupt(\"return\");\n\n              case 14:\n                user_id = \"\";\n\n                if (!window.sessionStorage.userInfo) {\n                  _context.next = 20;\n                  break;\n                }\n\n                userInfo = JSON.parse(window.sessionStorage.userInfo);\n                user_id = userInfo._id;\n                _context.next = 22;\n                break;\n\n              case 20:\n                this.$message({\n                  message: \"登录才能评论，请先登录！\",\n                  type: \"warning\"\n                });\n                return _context.abrupt(\"return\");\n\n              case 22:\n                this.btnLoading = true;\n                _context.next = 25;\n                return this.$https.post(this.$urls.addComment, {\n                  article_id: this.articleDetail._id,\n                  user_id: user_id,\n                  content: this.content\n                });\n\n              case 25:\n                this.btnLoading = false;\n                this.times++;\n                this.cacheTime = nowTime;\n                this.content = \"\";\n                this.$message({\n                  message: \"操作成功\",\n                  type: \"success\"\n                });\n                this.handleSearch();\n\n              case 31:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function handleAddComment() {\n        return _handleAddComment.apply(this, arguments);\n      }\n\n      return handleAddComment;\n    }()\n  }, {\n    key: \"beforeDestroy\",\n    value: function beforeDestroy() {\n      document.title = \"夜尽天明的博客网站\";\n      document.getElementById(\"keywords\").setAttribute(\"content\", \"夜尽天明 的博客网站\");\n      document.getElementById(\"description\").setAttribute(\"content\", \"分享大前端开发等相关的技术文章，热点资源，全栈程序员的成长之路。\");\n    } // // The class component now treats beforeRouteEnter\n    // // and beforeRouteLeave as Vue Router hooks\n    // beforeRouteEnter (to, from, next) {\n    //   console.log('beforeRouteEnter')\n    //   next() // needs to be called to confirm the navigation\n    // }\n    // beforeRouteLeave (to, from, next) {\n    //   console.log('beforeRouteLeave')\n    //   document.title = \"夜尽天明的博客网站\";\n    //   document\n    //     .getElementById(\"keywords\")\n    //     .setAttribute(\"content\", \"夜尽天明 的博客网站\");\n    //   document\n    //     .getElementById(\"description\")\n    //     .setAttribute(\n    //       \"content\",\n    //       \"分享大前端开发等相关的技术文章，热点资源，全栈程序员的成长之路。\"\n    //     );\n    //   next() // needs to be called to confirm the navigation\n    // }\n\n  }, {\n    key: \"handleSearch\",\n    value: function () {\n      var _handleSearch = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        var _this2 = this;\n\n        var data, article, keyword, description, title;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.isLoading = true;\n                _context2.next = 3;\n                return this.$https.post(this.$urls.getArticleDetail, this.params);\n\n              case 3:\n                data = _context2.sent;\n                this.isLoading = false;\n                this.articleDetail = data;\n                article = markdown.marked(data.content);\n                article.then(function (res) {\n                  _this2.articleDetail.content = res.content;\n                  _this2.articleDetail.toc = res.toc;\n                });\n                keyword = data.keyword.join(\",\");\n                description = data.desc;\n                title = data.title;\n                document.title = title;\n                document.querySelector(\"#keywords\").setAttribute(\"content\", keyword);\n                document.querySelector(\"#description\").setAttribute(\"content\", description);\n\n              case 14:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function handleSearch() {\n        return _handleSearch.apply(this, arguments);\n      }\n\n      return handleSearch;\n    }()\n  }, {\n    key: \"likeArticle\",\n    value: function () {\n      var _likeArticle = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee3() {\n        var user_id, userInfo, params;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (this.articleDetail._id) {\n                  _context3.next = 3;\n                  break;\n                }\n\n                this.$message({\n                  message: \"该文章不存在！\",\n                  type: \"warning\"\n                });\n                return _context3.abrupt(\"return\");\n\n              case 3:\n                if (!(this.likeTimes > 0)) {\n                  _context3.next = 6;\n                  break;\n                }\n\n                this.$message({\n                  message: \"您已经点过赞了！悠着点吧！\",\n                  type: \"warning\"\n                });\n                return _context3.abrupt(\"return\");\n\n              case 6:\n                user_id = \"\";\n\n                if (!window.sessionStorage.userInfo) {\n                  _context3.next = 12;\n                  break;\n                }\n\n                userInfo = JSON.parse(window.sessionStorage.userInfo);\n                user_id = userInfo._id;\n                _context3.next = 14;\n                break;\n\n              case 12:\n                this.$message({\n                  message: \"登录才能点赞，请先登录！\",\n                  type: \"warning\"\n                });\n                return _context3.abrupt(\"return\");\n\n              case 14:\n                params = {\n                  id: this.articleDetail._id,\n                  user_id: user_id\n                };\n                _context3.next = 17;\n                return this.$https.post(this.$urls.likeArticle, params);\n\n              case 17:\n                this.isLoading = false;\n                this.likeTimes++;\n                ++this.articleDetail.meta.likes;\n                this.$message({\n                  message: \"操作成功\",\n                  type: \"success\"\n                });\n\n              case 21:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function likeArticle() {\n        return _likeArticle.apply(this, arguments);\n      }\n\n      return likeArticle;\n    }()\n  }]);\n\n  return ArticleDetail;\n}(Vue);\n\nArticleDetail = tslib_1.__decorate([Component({\n  components: {\n    LoadingCustom: LoadingCustom,\n    CommentList: CommentList\n  }\n})], ArticleDetail);\nexport default ArticleDetail;",{"version":3,"sources":["E:\\WebStormProject\\blog-vue-typescript\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\WebStormProject\\blog-vue-typescript\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\WebStormProject\\blog-vue-typescript\\src\\views\\articleDetail.vue?vue&type=script&lang=ts&"],"names":[],"mappings":"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","sourcesContent":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\r\nimport {\r\n  timestampToTime,\r\n  getQueryStringByName,\r\n  isMobileOrPc\r\n} from \"@/utils/utils\";\r\nimport markdown from \"@/utils/markdown\";\r\nimport LoadingCustom from \"@/components/loading.vue\";\r\nimport CommentList from \"@/components/commentList.vue\";\r\nimport {\r\n  ArticleDetailIF,\r\n  LikeParams,\r\n  ArticleDetailParams\r\n} from \"@/types/index\";\r\n\r\ndeclare let document: Document | any;\r\n\r\n@Component({\r\n  components: {\r\n    LoadingCustom,\r\n    CommentList\r\n  }\r\n})\r\nexport default class ArticleDetail extends Vue {\r\n  private btnLoading: boolean = false;\r\n  private isLoadEnd: boolean = false;\r\n  private isLoading: boolean = false;\r\n  private isMobileOrPc: boolean = isMobileOrPc();\r\n  private params: ArticleDetailParams = {\r\n    id: \"\",\r\n    type: 1 //文章类型 => 1: 普通文章，2: 简历，3: 管理员介绍\r\n  };\r\n  private content: string = \"\";\r\n  private articleDetail: ArticleDetailIF = {\r\n    toc: \"\",\r\n    _id: \"\",\r\n    author: \"biaochenxuying\",\r\n    category: [],\r\n    comments: [],\r\n    create_time: \"\",\r\n    desc: \"\",\r\n    content: \"\",\r\n    id: 16,\r\n    img_url: \"\",\r\n    numbers: 0,\r\n    keyword: [],\r\n    like_users: [],\r\n    meta: { views: 0, likes: 0, comments: 0 },\r\n    origin: 0,\r\n    state: 1,\r\n    tags: [],\r\n    title: \"\",\r\n    update_time: \"\"\r\n  };\r\n  private cacheTime: number = 0; // 缓存时间\r\n  private times: number = 0; // 评论次数\r\n  private likeTimes: number = 0; // 点赞次数\r\n\r\n  mounted(): void {\r\n    this.params.id = this.$route.query.article_id;\r\n    // this.params.id = \"5c8cfe5d26bb39b22d3a7aec\";\r\n    if (this.$route.path === \"/about\") {\r\n      this.params.type = 3;\r\n    }\r\n    this.handleSearch();\r\n  }\r\n\r\n  refreshArticle(): void {\r\n    this.handleSearch();\r\n  }\r\n\r\n  private async handleAddComment(): Promise<void> {\r\n    if (!this.articleDetail._id) {\r\n      this.$message({\r\n        message: \"该文章不存在！\",\r\n        type: \"error\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (this.times > 2) {\r\n      this.$message({\r\n        message: \"您今天评论的次数已经用完，明天再来评论吧！\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    let now = new Date();\r\n    let nowTime = now.getTime();\r\n    if (nowTime - this.cacheTime < 4000) {\r\n      this.$message({\r\n        message: \"您评论太过频繁，1 分钟后再来留言吧！\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (!this.content) {\r\n      this.$message({\r\n        message: \"请输入内容!\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    }\r\n    let user_id = \"\";\r\n    if (window.sessionStorage.userInfo) {\r\n      let userInfo = JSON.parse(window.sessionStorage.userInfo);\r\n      user_id = userInfo._id;\r\n    } else {\r\n      this.$message({\r\n        message: \"登录才能评论，请先登录！\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    this.btnLoading = true;\r\n    await this.$https.post(this.$urls.addComment, {\r\n      article_id: this.articleDetail._id,\r\n      user_id,\r\n      content: this.content\r\n    });\r\n    this.btnLoading = false;\r\n    this.times++;\r\n    this.cacheTime = nowTime;\r\n    this.content = \"\";\r\n    this.$message({\r\n      message: \"操作成功\",\r\n      type: \"success\"\r\n    });\r\n    this.handleSearch();\r\n  }\r\n\r\n  beforeDestroy(): void {\r\n    document.title = \"夜尽天明的博客网站\";\r\n    document\r\n      .getElementById(\"keywords\")\r\n      .setAttribute(\"content\", \"夜尽天明 的博客网站\");\r\n    document\r\n      .getElementById(\"description\")\r\n      .setAttribute(\r\n        \"content\",\r\n        \"分享大前端开发等相关的技术文章，热点资源，全栈程序员的成长之路。\"\r\n      );\r\n  }\r\n\r\n  // // The class component now treats beforeRouteEnter\r\n  // // and beforeRouteLeave as Vue Router hooks\r\n  // beforeRouteEnter (to, from, next) {\r\n  //   console.log('beforeRouteEnter')\r\n  //   next() // needs to be called to confirm the navigation\r\n  // }\r\n\r\n  // beforeRouteLeave (to, from, next) {\r\n  //   console.log('beforeRouteLeave')\r\n  //   document.title = \"夜尽天明的博客网站\";\r\n  //   document\r\n  //     .getElementById(\"keywords\")\r\n  //     .setAttribute(\"content\", \"夜尽天明 的博客网站\");\r\n  //   document\r\n  //     .getElementById(\"description\")\r\n  //     .setAttribute(\r\n  //       \"content\",\r\n  //       \"分享大前端开发等相关的技术文章，热点资源，全栈程序员的成长之路。\"\r\n  //     );\r\n  //   next() // needs to be called to confirm the navigation\r\n  // }\r\n\r\n  async handleSearch(): Promise<void> {\r\n    this.isLoading = true;\r\n    const data: any = await this.$https.post(\r\n      this.$urls.getArticleDetail,\r\n      this.params\r\n    );\r\n    this.isLoading = false;\r\n\r\n    this.articleDetail = data;\r\n    const article = markdown.marked(data.content);\r\n    article.then((res: any) => {\r\n      this.articleDetail.content = res.content;\r\n      this.articleDetail.toc = res.toc;\r\n    });\r\n    let keyword = data.keyword.join(\",\");\r\n    let description = data.desc;\r\n    let title = data.title;\r\n    document.title = title;\r\n    document.querySelector(\"#keywords\").setAttribute(\"content\", keyword);\r\n    document.querySelector(\"#description\").setAttribute(\"content\", description);\r\n  }\r\n\r\n  async likeArticle(): Promise<void> {\r\n    if (!this.articleDetail._id) {\r\n      this.$message({\r\n        message: \"该文章不存在！\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (this.likeTimes > 0) {\r\n      this.$message({\r\n        message: \"您已经点过赞了！悠着点吧！\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    let user_id: string = \"\";\r\n    if (window.sessionStorage.userInfo) {\r\n      let userInfo = JSON.parse(window.sessionStorage.userInfo);\r\n      user_id = userInfo._id;\r\n    } else {\r\n      this.$message({\r\n        message: \"登录才能点赞，请先登录！\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    }\r\n    let params: LikeParams = {\r\n      id: this.articleDetail._id,\r\n      user_id\r\n    };\r\n    await this.$https.post(this.$urls.likeArticle, params);\r\n    this.isLoading = false;\r\n\r\n    this.likeTimes++;\r\n    ++this.articleDetail.meta.likes;\r\n    this.$message({\r\n      message: \"操作成功\",\r\n      type: \"success\"\r\n    });\r\n  }\r\n}\r\n"],"sourceRoot":""}]}