{"remainingRequest":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\babel-loader\\lib\\index.js!E:\\WebStormProject\\blog-vue-typescript\\node_modules\\ts-loader\\index.js??ref--13-2!E:\\WebStormProject\\blog-vue-typescript\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\WebStormProject\\blog-vue-typescript\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\WebStormProject\\blog-vue-typescript\\src\\components\\comment.vue?vue&type=script&lang=ts&","dependencies":[{"path":"E:\\WebStormProject\\blog-vue-typescript\\src\\components\\comment.vue","mtime":1573558720908},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\ts-loader\\index.js","mtime":1545640398000},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _Button2 from \"element-ui/lib/theme-chalk/button.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _Button from \"element-ui/lib/button\";\nimport _Input2 from \"element-ui/lib/theme-chalk/input.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _Input from \"element-ui/lib/input\";\nimport _FormItem2 from \"element-ui/lib/theme-chalk/form-item.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _FormItem from \"element-ui/lib/form-item\";\nimport _Form2 from \"element-ui/lib/theme-chalk/form.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _Form from \"element-ui/lib/form\";\nimport _Dialog2 from \"element-ui/lib/theme-chalk/dialog.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _Dialog from \"element-ui/lib/dialog\";\nimport _JSON$stringify from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/json/stringify\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"E:\\\\WebStormProject\\\\blog-vue-typescript\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/inherits\";\nimport * as tslib_1 from \"tslib\";\nimport { Component, Emit, Prop, Vue } from \"vue-property-decorator\";\n\nvar Comment =\n/*#__PURE__*/\nfunction (_Vue) {\n  _inherits(Comment, _Vue);\n\n  function Comment() {\n    var _this;\n\n    _classCallCheck(this, Comment);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Comment).apply(this, arguments)); // initial data\n\n    _this.btnLoading = false;\n    _this.content = \"\";\n    _this.cacheTime = 0; // 缓存时间\n\n    _this.times = 0; // 留言次数\n\n    return _this;\n  } // computed\n\n\n  _createClass(Comment, [{\n    key: \"cancel\",\n    // this.$emit\n    value: function cancel() {}\n  }, {\n    key: \"handleOk\",\n    value: function () {\n      var _handleOk = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var now, nowTime, user_id, userInfo;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (this.article_id) {\n                  _context.next = 3;\n                  break;\n                }\n\n                this.$message({\n                  message: \"该文章不存在！\",\n                  type: \"error\"\n                });\n                return _context.abrupt(\"return\");\n\n              case 3:\n                if (!(this.times > 2)) {\n                  _context.next = 6;\n                  break;\n                }\n\n                this.$message({\n                  message: \"您今天评论的次数已经用完，明天再来评论吧！\",\n                  type: \"warning\"\n                });\n                return _context.abrupt(\"return\");\n\n              case 6:\n                now = new Date();\n                nowTime = now.getTime();\n\n                if (!(nowTime - this.cacheTime < 4000)) {\n                  _context.next = 11;\n                  break;\n                }\n\n                this.$message({\n                  message: \"您评论太过频繁，1 分钟后再来评论吧！\",\n                  type: \"warning\"\n                });\n                return _context.abrupt(\"return\");\n\n              case 11:\n                if (this.content) {\n                  _context.next = 14;\n                  break;\n                }\n\n                this.$message({\n                  message: \"评论内容不能为空\",\n                  type: \"error\"\n                });\n                return _context.abrupt(\"return\");\n\n              case 14:\n                user_id = \"\";\n\n                if (!window.sessionStorage.userInfo) {\n                  _context.next = 20;\n                  break;\n                }\n\n                userInfo = JSON.parse(window.sessionStorage.userInfo);\n                user_id = userInfo._id;\n                _context.next = 22;\n                break;\n\n              case 20:\n                this.$message({\n                  message: \"登录才能评论，请先登录！\",\n                  type: \"warning\"\n                });\n                return _context.abrupt(\"return\");\n\n              case 22:\n                this.btnLoading = true;\n                _context.next = 25;\n                return this.$https.post(this.$urls.addThirdComment, {\n                  article_id: this.article_id,\n                  user_id: user_id,\n                  comment_id: this.comment_id,\n                  to_user: _JSON$stringify(this.to_user),\n                  content: this.content\n                });\n\n              case 25:\n                this.btnLoading = false;\n                this.times++;\n                this.cacheTime = nowTime;\n                this.content = \"\";\n                this.$message({\n                  message: \"操作成功\",\n                  type: \"success\"\n                });\n\n              case 30:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function handleOk() {\n        return _handleOk.apply(this, arguments);\n      }\n\n      return handleOk;\n    }()\n  }, {\n    key: \"dialogVisible\",\n    get: function get() {\n      return this.visible;\n    }\n  }]);\n\n  return Comment;\n}(Vue);\n\ntslib_1.__decorate([Prop({\n  default: false\n})], Comment.prototype, \"visible\", void 0);\n\ntslib_1.__decorate([Prop({\n  default: \"\"\n})], Comment.prototype, \"comment_id\", void 0);\n\ntslib_1.__decorate([Prop({\n  default: \"\"\n})], Comment.prototype, \"article_id\", void 0);\n\ntslib_1.__decorate([Prop({\n  default: {}\n})], Comment.prototype, \"to_user\", void 0);\n\ntslib_1.__decorate([Emit()], Comment.prototype, \"cancel\", null);\n\ntslib_1.__decorate([Emit(\"handleOk\")], Comment.prototype, \"handleOk\", null);\n\nComment = tslib_1.__decorate([Component({\n  components: {\n    Dialog: _Dialog,\n    Form: _Form,\n    FormItem: _FormItem,\n    Input: _Input,\n    Button: _Button\n  }\n})], Comment);\nexport default Comment;",{"version":3,"sources":["E:\\WebStormProject\\blog-vue-typescript\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\WebStormProject\\blog-vue-typescript\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\WebStormProject\\blog-vue-typescript\\src\\components\\comment.vue?vue&type=script&lang=ts&"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAwBA,SAAS,SAAT,EAAoB,IAApB,EAA0B,IAA1B,EAAgC,GAAhC,QAA2C,wBAA3C;;AAcA,IAAqB,OAArB;AAAA;AAAA;AAAA;;AATA,qBAAA;AAAA;;AAAA;;8FAAA,CAeE;;AACQ,UAAA,UAAA,GAAsB,KAAtB;AACA,UAAA,OAAA,GAAkB,EAAlB;AACA,UAAA,SAAA,GAAoB,CAApB,CAlBV,CAkBiC;;AACvB,UAAA,KAAA,GAAgB,CAAhB,CAnBV,CAmB6B;;AAnB7B;AA+FC,GAtFD,CAYE;;;AAZF;AAAA;AAiBE;AAjBF,6BAmBQ,CAAK;AAnBb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAuBS,KAAK,UAvBd;AAAA;AAAA;AAAA;;AAwBM,qBAAK,QAAL,CAAc;AACZ,kBAAA,OAAO,EAAE,SADG;AAEZ,kBAAA,IAAI,EAAE;AAFM,iBAAd;AAxBN;;AAAA;AAAA,sBA+BQ,KAAK,KAAL,GAAa,CA/BrB;AAAA;AAAA;AAAA;;AAgCM,qBAAK,QAAL,CAAc;AACZ,kBAAA,OAAO,EAAE,uBADG;AAEZ,kBAAA,IAAI,EAAE;AAFM,iBAAd;AAhCN;;AAAA;AAuCQ,gBAAA,GAvCR,GAuCc,IAAI,IAAJ,EAvCd;AAwCQ,gBAAA,OAxCR,GAwCkB,GAAG,CAAC,OAAJ,EAxClB;;AAAA,sBAyCQ,OAAO,GAAG,KAAK,SAAf,GAA2B,IAzCnC;AAAA;AAAA;AAAA;;AA0CM,qBAAK,QAAL,CAAc;AACZ,kBAAA,OAAO,EAAE,qBADG;AAEZ,kBAAA,IAAI,EAAE;AAFM,iBAAd;AA1CN;;AAAA;AAAA,oBAiDS,KAAK,OAjDd;AAAA;AAAA;AAAA;;AAkDM,qBAAK,QAAL,CAAc;AACZ,kBAAA,OAAO,EAAE,UADG;AAEZ,kBAAA,IAAI,EAAE;AAFM,iBAAd;AAlDN;;AAAA;AAyDQ,gBAAA,OAzDR,GAyDkB,EAzDlB;;AAAA,qBA0DQ,MAAM,CAAC,cAAP,CAAsB,QA1D9B;AAAA;AAAA;AAAA;;AA2DU,gBAAA,QA3DV,GA2DqB,IAAI,CAAC,KAAL,CAAW,MAAM,CAAC,cAAP,CAAsB,QAAjC,CA3DrB;AA4DM,gBAAA,OAAO,GAAG,QAAQ,CAAC,GAAnB;AA5DN;AAAA;;AAAA;AA8DM,qBAAK,QAAL,CAAc;AACZ,kBAAA,OAAO,EAAE,cADG;AAEZ,kBAAA,IAAI,EAAE;AAFM,iBAAd;AA9DN;;AAAA;AAoEI,qBAAK,UAAL,GAAkB,IAAlB;AApEJ;AAAA,uBAqEU,KAAK,MAAL,CAAY,IAAZ,CAAiB,KAAK,KAAL,CAAW,eAA5B,EAA6C;AACjD,kBAAA,UAAU,EAAE,KAAK,UADgC;AAEjD,kBAAA,OAAO,EAAP,OAFiD;AAGjD,kBAAA,UAAU,EAAE,KAAK,UAHgC;AAIjD,kBAAA,OAAO,EAAE,gBAAe,KAAK,OAApB,CAJwC;AAKjD,kBAAA,OAAO,EAAE,KAAK;AALmC,iBAA7C,CArEV;;AAAA;AA4EI,qBAAK,UAAL,GAAkB,KAAlB;AACA,qBAAK,KAAL;AAEA,qBAAK,SAAL,GAAiB,OAAjB;AACA,qBAAK,OAAL,GAAe,EAAf;AACA,qBAAK,QAAL,CAAc;AACZ,kBAAA,OAAO,EAAE,MADG;AAEZ,kBAAA,IAAI,EAAE;AAFM,iBAAd;;AAjFJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,wBAamB;AACf,aAAO,KAAK,OAAZ;AACD;AAfH;;AAAA;AAAA,EAAqC,GAArC,CAAA;;AAC4B,OAAA,CAAA,UAAA,CAAA,CAAzB,IAAI,CAAC;AAAE,EAAA,OAAO,EAAE;AAAX,CAAD,CAAqB,CAAA,E,iBAAA,E,SAAA,E,KAAkB,CAAlB;;AACH,OAAA,CAAA,UAAA,CAAA,CAAtB,IAAI,CAAC;AAAE,EAAA,OAAO,EAAE;AAAX,CAAD,CAAkB,CAAA,E,iBAAA,E,YAAA,E,KAAoB,CAApB;;AACA,OAAA,CAAA,UAAA,CAAA,CAAtB,IAAI,CAAC;AAAE,EAAA,OAAO,EAAE;AAAX,CAAD,CAAkB,CAAA,E,iBAAA,E,YAAA,E,KAAoB,CAApB;;AACA,OAAA,CAAA,UAAA,CAAA,CAAtB,IAAI,CAAC;AAAE,EAAA,OAAO,EAAE;AAAX,CAAD,CAAkB,CAAA,E,iBAAA,E,SAAA,E,KAAiB,CAAjB;;AAevB,OAAA,CAAA,UAAA,CAAA,CADC,IAAI,EACL,CAAA,E,iBAAA,E,QAAA,EAAW,IAAX;;AAGA,OAAA,CAAA,UAAA,CAAA,CADC,IAAI,CAAC,UAAD,CACL,CAAA,E,iBAAA,E,UAAA,EA+DC,IA/DD;;AAtBmB,OAAO,GAAA,OAAA,CAAA,UAAA,CAAA,CAT3B,SAAS,CAAC;AACT,EAAA,UAAU,EAAE;AACV,IAAA,MAAM,SADI;AAEV,IAAA,IAAI,OAFM;AAGV,IAAA,QAAQ,WAHE;AAIV,IAAA,KAAK,QAJK;AAKV,IAAA,MAAM;AALI;AADH,CAAD,CASkB,CAAA,EAAP,OAAO,CAAP;eAAA,O","sourcesContent":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Emit, Prop, Vue } from \"vue-property-decorator\";\r\nimport { Dialog, Form, FormItem, Input, Button, Message } from \"element-ui\";\r\nimport config from \"@/utils/config\";\r\nimport { ToUser } from \"@/types/index\";\r\n\r\n@Component({\r\n  components: {\r\n    Dialog,\r\n    Form,\r\n    FormItem,\r\n    Input,\r\n    Button\r\n  }\r\n})\r\nexport default class Comment extends Vue {\r\n  @Prop({ default: false }) visible!: boolean;\r\n  @Prop({ default: \"\" }) comment_id!: string;\r\n  @Prop({ default: \"\" }) article_id!: string;\r\n  @Prop({ default: {} }) to_user!: ToUser;\r\n\r\n  // initial data\r\n  private btnLoading: boolean = false;\r\n  private content: string = \"\";\r\n  private cacheTime: number = 0; // 缓存时间\r\n  private times: number = 0; // 留言次数\r\n\r\n  // computed\r\n  get dialogVisible(): boolean {\r\n    return this.visible;\r\n  }\r\n\r\n  // this.$emit\r\n  @Emit()\r\n  cancel() {}\r\n\r\n  @Emit(\"handleOk\")\r\n  private async handleOk(): Promise<void> {\r\n    if (!this.article_id) {\r\n      this.$message({\r\n        message: \"该文章不存在！\",\r\n        type: \"error\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (this.times > 2) {\r\n      this.$message({\r\n        message: \"您今天评论的次数已经用完，明天再来评论吧！\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    let now = new Date();\r\n    let nowTime = now.getTime();\r\n    if (nowTime - this.cacheTime < 4000) {\r\n      this.$message({\r\n        message: \"您评论太过频繁，1 分钟后再来评论吧！\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (!this.content) {\r\n      this.$message({\r\n        message: \"评论内容不能为空\",\r\n        type: \"error\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    let user_id = \"\";\r\n    if (window.sessionStorage.userInfo) {\r\n      let userInfo = JSON.parse(window.sessionStorage.userInfo);\r\n      user_id = userInfo._id;\r\n    } else {\r\n      this.$message({\r\n        message: \"登录才能评论，请先登录！\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    }\r\n    this.btnLoading = true;\r\n    await this.$https.post(this.$urls.addThirdComment, {\r\n      article_id: this.article_id,\r\n      user_id,\r\n      comment_id: this.comment_id,\r\n      to_user: JSON.stringify(this.to_user),\r\n      content: this.content\r\n    });\r\n    this.btnLoading = false;\r\n    this.times++;\r\n\r\n    this.cacheTime = nowTime;\r\n    this.content = \"\";\r\n    this.$message({\r\n      message: \"操作成功\",\r\n      type: \"success\"\r\n    });\r\n  }\r\n}\r\n"],"sourceRoot":""}]}