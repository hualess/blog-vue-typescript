{"remainingRequest":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\WebStormProject\\blog-vue-typescript\\src\\views\\message.vue?vue&type=script&lang=ts&","dependencies":[{"path":"E:\\WebStormProject\\blog-vue-typescript\\src\\views\\message.vue","mtime":1573558720919},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\ts-loader\\index.js","mtime":1545640398000},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\WebStormProject\\blog-vue-typescript\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport Vue from \"vue\";\r\nimport Component from \"vue-class-component\";\r\nimport { MessageParams, RulesItem, Rules } from \"@/types/index\";\r\n\r\nconst check = (\r\n  rule: any,\r\n  value: string | any,\r\n  callback: Function | any\r\n): any => {\r\n  if (!value) {\r\n    return callback(new Error(\"邮箱不能为空\"));\r\n  }\r\n};\r\nconst checkPhone = (\r\n  rule: any,\r\n  value: string | any,\r\n  callback: Function | any\r\n): any => {\r\n  if (!value) {\r\n    return callback(new Error(\"手机不能为空\"));\r\n  }\r\n};\r\nconst checkName = (\r\n  rule: any,\r\n  value: string | any,\r\n  callback: Function | any\r\n): any => {\r\n  if (!value) {\r\n    return callback(new Error(\"名字不能为空\"));\r\n  }\r\n};\r\nconst checkContent = (\r\n  rule: any,\r\n  value: string | any,\r\n  callback: Function | any\r\n) => {\r\n  if (!value) {\r\n    return callback(new Error(\"内容不能为空\"));\r\n  }\r\n};\r\n\r\n@Component({})\r\nexport default class Message extends Vue {\r\n  // initial data\r\n  private btnLoading: boolean = false;\r\n  private cacheTime: number = 0; // 缓存时间\r\n  private times: number = 0; // 留言次数\r\n  private params: MessageParams = {\r\n    email: \"\",\r\n    phone: \"\",\r\n    name: \"\",\r\n    content: \"\"\r\n  };\r\n  private rules: Rules = {\r\n    email: [{ validator: check, trigger: \"blur\" }],\r\n    phone: [{ validator: checkPhone, trigger: \"blur\" }],\r\n    name: [{ validator: checkName, trigger: \"blur\" }],\r\n    content: [{ validator: checkContent, trigger: \"blur\" }]\r\n  };\r\n\r\n  // use prop values for initial data\r\n\r\n  // lifecycle hook\r\n  mounted() {}\r\n\r\n  // method\r\n  private async submit(): Promise<void> {\r\n    if (this.times > 3) {\r\n      this.$message({\r\n        message: \"您今天留言的次数已经用完，明天再来留言吧！\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    let now = new Date();\r\n    let nowTime = now.getTime();\r\n    if (nowTime - this.cacheTime < 60000) {\r\n      this.$message({\r\n        message: \"您留言太过频繁，1 分钟后再来留言吧！\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    const reg: RegExp = new RegExp(\r\n      \"^[a-z0-9]+([._\\\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$\"\r\n    );\r\n    if (!this.params.email) {\r\n      this.$message({\r\n        message: \"邮箱不能为空！\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    } else if (!reg.test(this.params.email)) {\r\n      this.$message({\r\n        message: \"请输入格式正确的邮箱！\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    } else if (!this.params.phone) {\r\n      this.$message({\r\n        message: \"手机不能为空\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    } else if (!this.params.name) {\r\n      this.$message({\r\n        message: \"名字不能为空\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    } else if (!this.params.content) {\r\n      this.$message({\r\n        message: \"内容不能为空\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    }\r\n    this.btnLoading = true;\r\n    await this.$https.post(this.$urls.addMessage, this.params);\r\n    this.btnLoading = false;\r\n\r\n    this.times++;\r\n    this.cacheTime = nowTime;\r\n    this.$message({\r\n      message: \"感谢您的留言，有必要的，博主有空都会回复您的 ！\",\r\n      type: \"success\"\r\n    });\r\n    this.params.content = \"\";\r\n  }\r\n}\r\n",{"version":3,"sources":["message.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"message.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"message left\">\r\n    <el-form :model=\"params\"\r\n             status-icon\r\n             :rules=\"rules\"\r\n             ref=\"params\"\r\n             label-width=\"50px\"\r\n             class=\"demo-ruleForm\">\r\n      <el-form-item label=\"邮箱\"\r\n                    prop=\"email\">\r\n        <el-input type=\"text\"\r\n                  placeholder=\"必填\"\r\n                  v-model=\"params.email\"\r\n                  autocomplete=\"off\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"手机\"\r\n                    prop=\"phone\">\r\n        <el-input v-model=\"params.phone\"\r\n                  autocomplete=\"off\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"名字\"\r\n                    prop=\"name\">\r\n        <el-input v-model=\"params.name\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"内容\"\r\n                    prop=\"content\">\r\n        <el-input type=\"textarea\"\r\n                  placeholder=\"必填\"\r\n                  v-model=\"params.content\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\"\r\n                   :loading=\"btnLoading\"\r\n                   @click=\"submit\">提交</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport Vue from \"vue\";\r\nimport Component from \"vue-class-component\";\r\nimport { MessageParams, RulesItem, Rules } from \"@/types/index\";\r\n\r\nconst check = (\r\n  rule: any,\r\n  value: string | any,\r\n  callback: Function | any\r\n): any => {\r\n  if (!value) {\r\n    return callback(new Error(\"邮箱不能为空\"));\r\n  }\r\n};\r\nconst checkPhone = (\r\n  rule: any,\r\n  value: string | any,\r\n  callback: Function | any\r\n): any => {\r\n  if (!value) {\r\n    return callback(new Error(\"手机不能为空\"));\r\n  }\r\n};\r\nconst checkName = (\r\n  rule: any,\r\n  value: string | any,\r\n  callback: Function | any\r\n): any => {\r\n  if (!value) {\r\n    return callback(new Error(\"名字不能为空\"));\r\n  }\r\n};\r\nconst checkContent = (\r\n  rule: any,\r\n  value: string | any,\r\n  callback: Function | any\r\n) => {\r\n  if (!value) {\r\n    return callback(new Error(\"内容不能为空\"));\r\n  }\r\n};\r\n\r\n@Component({})\r\nexport default class Message extends Vue {\r\n  // initial data\r\n  private btnLoading: boolean = false;\r\n  private cacheTime: number = 0; // 缓存时间\r\n  private times: number = 0; // 留言次数\r\n  private params: MessageParams = {\r\n    email: \"\",\r\n    phone: \"\",\r\n    name: \"\",\r\n    content: \"\"\r\n  };\r\n  private rules: Rules = {\r\n    email: [{ validator: check, trigger: \"blur\" }],\r\n    phone: [{ validator: checkPhone, trigger: \"blur\" }],\r\n    name: [{ validator: checkName, trigger: \"blur\" }],\r\n    content: [{ validator: checkContent, trigger: \"blur\" }]\r\n  };\r\n\r\n  // use prop values for initial data\r\n\r\n  // lifecycle hook\r\n  mounted() {}\r\n\r\n  // method\r\n  private async submit(): Promise<void> {\r\n    if (this.times > 3) {\r\n      this.$message({\r\n        message: \"您今天留言的次数已经用完，明天再来留言吧！\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    let now = new Date();\r\n    let nowTime = now.getTime();\r\n    if (nowTime - this.cacheTime < 60000) {\r\n      this.$message({\r\n        message: \"您留言太过频繁，1 分钟后再来留言吧！\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    const reg: RegExp = new RegExp(\r\n      \"^[a-z0-9]+([._\\\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$\"\r\n    );\r\n    if (!this.params.email) {\r\n      this.$message({\r\n        message: \"邮箱不能为空！\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    } else if (!reg.test(this.params.email)) {\r\n      this.$message({\r\n        message: \"请输入格式正确的邮箱！\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    } else if (!this.params.phone) {\r\n      this.$message({\r\n        message: \"手机不能为空\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    } else if (!this.params.name) {\r\n      this.$message({\r\n        message: \"名字不能为空\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    } else if (!this.params.content) {\r\n      this.$message({\r\n        message: \"内容不能为空\",\r\n        type: \"warning\"\r\n      });\r\n      return;\r\n    }\r\n    this.btnLoading = true;\r\n    await this.$https.post(this.$urls.addMessage, this.params);\r\n    this.btnLoading = false;\r\n\r\n    this.times++;\r\n    this.cacheTime = nowTime;\r\n    this.$message({\r\n      message: \"感谢您的留言，有必要的，博主有空都会回复您的 ！\",\r\n      type: \"success\"\r\n    });\r\n    this.params.content = \"\";\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.message {\r\n  padding: 100px 20px 0 20px;\r\n}\r\n</style>\r\n"]}]}